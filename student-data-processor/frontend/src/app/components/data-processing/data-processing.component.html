<div class="data-processing-container">
  <!-- Header -->
  <div class="header">
    <h2>Excel to CSV Processing</h2>
    <p class="subtitle">Upload an Excel file to convert it to CSV format with +10 score adjustment</p>
  </div>

  <!-- File Upload Form -->
  <div class="processing-form">
    <div class="form-group">
      <label for="fileInput">Select Excel File (.xlsx or .xls)</label>
      <input
        type="file"
        class="form-control"
        id="fileInput"
        accept=".xlsx,.xls"
        (change)="onFileSelected($event)"
        [disabled]="isProcessing">
    </div>

    <div *ngIf="selectedFile" class="alert alert-success">
      <strong>Selected File:</strong> {{ selectedFile.name }}<br>
      <strong>Size:</strong> {{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB
    </div>

    <button
      type="button"
      class="btn btn-primary"
      [disabled]="!selectedFile || isProcessing"
      (click)="processFile()">
      {{ isProcessing ? 'Processing...' : 'Convert to CSV' }}
    </button>
  </div>

  <!-- Processing Indicator -->
  <div *ngIf="isProcessing" class="progress-container">
    <div class="progress-bar">
      <div class="progress-fill"></div>
    </div>
    <p class="progress-text">Processing Excel file and applying +10 score adjustment...</p>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="alert alert-success">
    <h3>Success!</h3>
    <p>{{ successMessage }}</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error">
    <h3>Error</h3>
    <p>{{ errorMessage }}</p>
  </div>

  <!-- Processing Result -->
  <div *ngIf="lastProcessingResult" class="result-card">
    <h3>Processing Complete</h3>
    <div class="result-details">
      <div class="result-item">
        <strong>Original File</strong>
        <span>{{ lastProcessingResult.originalFileName }}</span>
      </div>
      <div class="result-item">
        <strong>CSV File Created</strong>
        <span>{{ lastProcessingResult.csvFileName }}</span>
      </div>
      <div class="result-item">
        <strong>Records Processed</strong>
        <span>{{ lastProcessingResult.recordsProcessed }}</span>
      </div>
      <div class="result-item">
        <strong>Processing Time</strong>
        <span>{{ lastProcessingResult.processingTime }}</span>
      </div>
      <div class="result-item">
        <strong>Score Adjustment</strong>
        <span>{{ lastProcessingResult.scoreAdjustment }}</span>
      </div>
    </div>
  </div>

  <!-- Workflow Navigation -->
  <div class="workflow-nav" *ngIf="lastProcessingResult && !isProcessing">
    <h3>Next Steps</h3>
    <a routerLink="/generate" class="btn-workflow">
      ‚Üê Back to Data Generation
    </a>
  </div>
</div>
