<div class="data-processing-container" style="padding: 2rem; background-color: #f8f9fa; min-height: 100vh; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
  <!-- Header -->
  <div class="header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important; color: white !important; padding: 2rem; border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.15); margin-bottom: 2rem; text-align: center;">
    <h2 style="color: white !important; font-size: 1.8rem; font-weight: 600; margin: 0 0 0.5rem 0;">📊 Excel to CSV Processing</h2>
    <p class="subtitle" style="color: white !important; margin: 0; opacity: 0.9; font-size: 1rem;">Upload an Excel file to convert it to CSV format with +10 score adjustment</p>
  </div>

  <!-- File Upload Form -->
  <div class="processing-form" style="background: white; border-radius: 12px; padding: 2rem; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin-bottom: 2rem;">
    <div class="form-group" style="margin-bottom: 2rem;">
      <label for="fileInput" style="display: block; margin-bottom: 0.75rem; font-weight: 600; color: #2c3e50; font-size: 1.1rem;">📁 Select Excel File (.xlsx or .xls)</label>
      <input
        type="file"
        class="form-control"
        id="fileInput"
        accept=".xlsx,.xls"
        (change)="onFileSelected($event)"
        [disabled]="isProcessing"
        style="width: 100%; padding: 1rem; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 1rem; background: #f8f9fa; transition: all 0.3s ease;">
    </div>

    <div *ngIf="selectedFile" class="alert alert-success" style="padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(52, 199, 89, 0.1) 100%); border-left: 4px solid #28a745; color: #155724; font-weight: 500;">
      <strong>✅ Selected File:</strong> {{ selectedFile.name }}<br>
      <strong>📏 Size:</strong> {{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB
    </div>

    <button
      type="button"
      class="btn btn-primary"
      [disabled]="!selectedFile || isProcessing"
      (click)="processFile()"
      style="padding: 0.875rem 2rem; border: none; border-radius: 12px; font-size: 0.95rem; font-weight: 600; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
      {{ isProcessing ? '⏳ Processing...' : '🚀 Convert to CSV' }}
    </button>
  </div>

  <!-- Processing Indicator -->
  <div *ngIf="isProcessing" class="progress-container" style="background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); text-align: center; margin-bottom: 2rem;">
    <div class="progress-bar" style="width: 100%; height: 12px; background: #e2e8f0; border-radius: 6px; overflow: hidden; margin: 1rem 0;">
      <div class="progress-fill" style="height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 6px; animation: pulse 2s ease-in-out infinite; width: 70%;"></div>
    </div>
    <p class="progress-text" style="color: #495057; font-weight: 600; margin-top: 1rem;">⚙️ Processing Excel file and applying +10 score adjustment...</p>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="alert alert-success" style="padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(52, 199, 89, 0.1) 100%); border-left: 4px solid #28a745; color: #155724; font-weight: 500; box-shadow: 0 4px 12px rgba(40, 167, 69, 0.2);">
    <h3 style="margin: 0 0 0.5rem 0; color: #155724; font-size: 1.2rem; font-weight: 600;">🎉 Success!</h3>
    <p style="margin: 0; color: #155724;">{{ successMessage }}</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error" style="padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; background: linear-gradient(135deg, rgba(220, 53, 69, 0.1) 0%, rgba(255, 193, 7, 0.1) 100%); border-left: 4px solid #dc3545; color: #721c24; font-weight: 500; box-shadow: 0 4px 12px rgba(220, 53, 69, 0.2);">
    <h3 style="margin: 0 0 0.5rem 0; color: #dc3545; font-size: 1.2rem; font-weight: 600;">❌ Error</h3>
    <p style="margin: 0; color: #721c24;">{{ errorMessage }}</p>
  </div>

  <!-- Processing Result -->
  <div *ngIf="lastProcessingResult" class="result-card" style="background: white; border-radius: 12px; padding: 2rem; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin-bottom: 2rem; border: 1px solid #e9ecef;">
    <h3 style="margin: 0 0 1.5rem 0; color: #2c3e50; font-size: 1.5rem; font-weight: 600; text-align: center;">✅ Processing Complete</h3>
    <div class="result-details" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
      <div class="result-item" style="background: #f8f9fa; border-radius: 8px; padding: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
        <strong style="color: #667eea; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;">📄 Original File</strong>
        <span style="color: #2c3e50; font-weight: 500;">{{ lastProcessingResult.originalFileName }}</span>
      </div>
      <div class="result-item" style="background: #f8f9fa; border-radius: 8px; padding: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
        <strong style="color: #667eea; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;">📊 CSV File Created</strong>
        <span style="color: #2c3e50; font-weight: 500;">{{ lastProcessingResult.csvFileName }}</span>
      </div>
      <div class="result-item" style="background: #f8f9fa; border-radius: 8px; padding: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
        <strong style="color: #667eea; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;">📈 Records Processed</strong>
        <span style="color: #2c3e50; font-weight: 500; font-size: 1.1rem;">{{ lastProcessingResult.recordsProcessed }}</span>
      </div>
      <div class="result-item" style="background: #f8f9fa; border-radius: 8px; padding: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
        <strong style="color: #667eea; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;">⏱️ Processing Time</strong>
        <span style="color: #2c3e50; font-weight: 500;">{{ lastProcessingResult.processingTime }}</span>
      </div>
      <div class="result-item" style="background: #f8f9fa; border-radius: 8px; padding: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
        <strong style="color: #667eea; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em;">🚀 Score Adjustment</strong>
        <span style="color: #28a745; font-weight: 600; font-size: 1.1rem;">{{ lastProcessingResult.scoreAdjustment }}</span>
      </div>
    </div>
  </div>

  <!-- Workflow Navigation -->
  <div class="workflow-nav" *ngIf="lastProcessingResult && !isProcessing" style="background: white; border-radius: 12px; padding: 2rem; box-shadow: 0 8px 25px rgba(0,0,0,0.1); text-align: center;">
    <h3 style="margin: 0 0 1.5rem 0; color: #2c3e50; font-size: 1.3rem; font-weight: 600;">🔄 Next Steps</h3>
    <a routerLink="/generate" class="btn-workflow" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.875rem 2rem; background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white; text-decoration: none; border-radius: 12px; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);">
      ← Back to Data Generation
    </a>
  </div>
</div>
