<div class="processing-container">
  <!-- Header Section -->
  <div class="header-section">
    <h1>üìä Excel to CSV Processing - Objective B</h1>
    <p>Convert Excel files to CSV format with automatic +10 score adjustment</p>
  </div>

  <!-- Upload Section -->
  <div class="upload-section">
    <div class="upload-card">
      <h2>Upload Excel File</h2>

      <div class="file-input-area">
        <input
          type="file"
          #fileInput
          id="fileInput"
          accept=".xlsx,.xls"
          (change)="onFileSelected($event)"
          [disabled]="isProcessing"
          style="display: none;">

        <div
          class="drop-zone"
          [class.has-file]="selectedFile"
          [class.processing]="isProcessing"
          (click)="fileInput.click()">

          <div class="drop-zone-content">
            <div class="file-icon">üìÅ</div>
            <div class="drop-text" *ngIf="!selectedFile">
              <strong>Click to select Excel file</strong>
              <span>or drag and drop here</span>
            </div>
            <div class="file-info" *ngIf="selectedFile">
              <div class="file-name">{{ selectedFile.name }}</div>
              <div class="file-size">{{ formatFileSize(selectedFile.size) }}</div>
            </div>
          </div>
        </div>
      </div>

      <div class="file-requirements">
        <h3>File Requirements:</h3>
        <ul>
          <li>‚úÖ Excel format (.xlsx or .xls)</li>
          <li>‚úÖ Contains student data columns</li>
          <li>‚úÖ Maximum size: 100MB</li>
          <li>‚úÖ Will apply +10 score adjustment</li>
        </ul>
      </div>

      <button
        class="process-btn"
        [disabled]="!selectedFile || isProcessing"
        (click)="processFile()">
        <span *ngIf="!isProcessing">üöÄ Convert to CSV</span>
        <span *ngIf="isProcessing">‚è≥ Processing...</span>
      </button>
    </div>
  </div>

  <!-- Processing Status -->
  <div class="status-section" *ngIf="isProcessing">
    <div class="progress-card">
      <h3>Processing Excel File...</h3>
      <div class="progress-bar">
        <div class="progress-fill"></div>
      </div>
      <p>Converting Excel to CSV and applying +10 score adjustment...</p>
    </div>
  </div>

  <!-- Results Section -->
  <div class="results-section" *ngIf="processingResult && !isProcessing">
    <div class="success-card">
      <h3>‚úÖ Processing Complete!</h3>
      <div class="result-grid">
        <div class="result-item">
          <span class="label">Original File:</span>
          <span class="value">{{ processingResult.originalFileName }}</span>
        </div>
        <div class="result-item">
          <span class="label">CSV File:</span>
          <span class="value">{{ processingResult.csvFileName }}</span>
        </div>
        <div class="result-item">
          <span class="label">Records Processed:</span>
          <span class="value">{{ processingResult.recordsProcessed }}</span>
        </div>
        <div class="result-item">
          <span class="label">Processing Time:</span>
          <span class="value">{{ processingResult.processingTime }}</span>
        </div>
        <div class="result-item">
          <span class="label">Score Adjustment:</span>
          <span class="value">+10 points applied</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Error Display -->
  <div class="error-section" *ngIf="errorMessage">
    <div class="error-card">
      <h3>‚ùå Processing Error</h3>
      <p>{{ errorMessage }}</p>
      <button class="retry-btn" (click)="resetForm()">Try Again</button>
    </div>
  </div>

  <!-- Navigation -->
  <div class="navigation-section" *ngIf="processingResult && !isProcessing">
    <h3>üéØ Next Steps</h3>
    <div class="nav-buttons">
      <a routerLink="/generate" class="nav-btn secondary">
        ‚Üê Back to Data Generation
      </a>
      <a routerLink="/upload" class="nav-btn primary">
        Upload CSV to Database ‚Üí
      </a>
    </div>
  </div>
</div>
